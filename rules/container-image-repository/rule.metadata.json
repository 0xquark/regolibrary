{
    "name": "container-image-repository",
    "attributes": {
      "m$K8sThreatMatrix": "Collection::Images from private registry",
      "armoBuiltin": true
    },
    "ruleLanguage": "Rego",
    "match": [
      {
        "apiGroups": [
          "*"
        ],
        "apiVersions": [
          "*"
        ],
        "resources": [
          "Pods",
          "Deployment",
          "ReplicaSet",
          "DaemonSet",
          "StatefulSet",
          "Job",
          "CronJob"
        ]
      }
    ],
    "ruleDependencies": [],
    "configInputs": ["settings.postureControlInputs.imageRepositoryAllowList"],
    "description": "fails if image is not from allowlisted registry (microsoft, google, azure) and also has no imagePullSecrets",
    "remediation": "",
    "ruleQuery": ""
  }