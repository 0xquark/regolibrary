package armo_builtins

deny[msga] {
	node := input[_]
    node.kind == "Node"
    kernelVersionMatch := regex.find_all_string_submatch_n("[0-9]+\\.[0-9]+\\.[0-9]+", node.status.nodeInfo.kernelVersion, -1)
    kernelVersion := kernelVersionMatch[0][0]
    kernelVersion > "5.1"
    kernelVersion < "5.16.2"

   node.status.nodeInfo.operatingSystem == "linux"
   path := "status.nodeInfo.kernelVersion"

	msga := {
			"alertMessage": "You are vulnerable to CVE-2022-0185",
			"alertObject": {
            "k8SApiObjects": [node]
            },
			"failedPaths": [path],
	}
}