{
  "name": "rule-identify-blocklisted-image-registries",
  "attributes": {
    "m$K8sThreatMatrix": "Initial Access::Compromised images in registry",
    "armoBuiltin": true
  },
  "ruleLanguage": "Rego",
  "match": [
    {
      "apiGroups": [
        "*"
      ],
      "apiVersions": [
        "*"
      ],
      "resources": [
        "Pods",
        "Deployment",
        "ReplicaSet",
        "DaemonSet",
        "StatefulSet",
        "Job",
        "CronJob"
      ]
    }
  ],
  "ruleDependencies": [],
  "configInputs": [
    "settings.postureControlInputs.publicRegistries",
    "settings.postureControlInputs.untrustedRegistries",
    "settings.postureControlInputs.publicRegistriesAllowlist",
    "settings.postureControlInputs.untrustedRegistriesAllowlist"
  ],
  "controlConfigInputs": [
    {
      "path": "settings.postureControlInputs.publicRegistries",
      "name": "Public registries",
      "description": "Kubescape checks none of these public registries are in use."
    },
    {
      "path": "settings.postureControlInputs.untrustedRegistries",
      "name": "Untrusted registries",
      "description": "Kubescape checks none of the following registries are in use."
    },
    {
      "path": "settings.postureControlInputs.publicRegistriesAllowlist",
      "name": "Public registries allowlist",
      "description": "Allowlist for public registries."
    },
    {
      "path": "settings.postureControlInputs.untrustedRegistriesAllowlist",
      "name": "Untrusted registries allowlist",
      "description": "Allowlist for untrusted registries."
    }
  ],
  "description": "Identifying if pod container images are from forbidden registries",
  "remediation": "Use images from safe registry",
  "ruleQuery": ""
}