{
    "name": "Control plane hardening",
    "attributes": {
        "armoBuiltin": true
    },
    "description": "Kubernetes control plane API is running with non-secure port enabled which allows attackers to gain unprotected access to the cluster.",
    "remediation": "Set the insecure-port flag of the API server to zero.",
    "rulesNames": [
        "insecure-port-flag"
    ],
    "id": "C-0005",
    "long_description": "The control plane is the core of Kubernetes and gives users the ability to view containers, schedule new Pods, read Secrets, and execute commands in the cluster. Thus, it should be highly protected. It should not be exposed to the Internet or to an untrusted network.  The API server, which runs on ports 6443 and 8080, should be protected by a firewall. Port 8080, if accessed through the local machine, does not require TLS encryption, and the request bypasses authentication and authorization modules.",
    "test": "Check if the insecure-port flag is set (in case of cloud providers this is not possible to access, so we are not alerting)."
}